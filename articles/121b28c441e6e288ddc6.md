---
title: "Security Keyã‚’åˆ©ç”¨ã—ãŸSSH Git operationsã‚’è©¦ã—ã¦ã¿ãŸ"
emoji: "ğŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: true 
---
Gitæ“ä½œã«ãŠã„ã¦Security KeyãŒåˆ©ç”¨ã§ãã‚‹æ§˜ã«ãªã£ãŸã¨ã®ã“ã¨ã§è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚
https://github.blog/2021-05-10-security-keys-supported-ssh-git-operations/

å®Ÿæ–½ã™ã‚‹ã¾ãˆã«opensshã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æœ€æ–°ã«ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ãã†ã§ã™ã€‚
```
$ brew install openssh
```

ä»¥ä¸‹ã®é€šã‚Šãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒ‡å®šã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
```
$ ssh-keygen -t ecdsa-sk -C <email address> 
Generating public/private ecdsa-sk key pair.
You may need to touch your authenticator to authorize key generation.
Enter file in which to save the key (/path/.ssh/id_ecdsa_sk):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /path/.ssh/id_ecdsa_sk
Your public key has been saved in /path/.ssh/id_ecdsa_sk.pub
The key fingerprint is:
SHA256:<finger print> <email address> 
The key's randomart image is:
+-[ECDSA-SK 256]--+
|             ....|
|           . o. o|
|          o OE+.o|
|         . %.Xo =|
|        S o X.+*.|
|          ..oOBoo|
|         . o+X++ |
|          . + * .|
|           . o . |
+----[SHA256]-----+
```
PCã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹Security Keyã‚’èªè­˜ã—ã¦User PresenceãŒè¦æ±‚ã•ã‚Œã‚‹ã€‚ãã®å¾Œã¯ãƒ‘ã‚¹ãƒ•ãƒ¬ãƒ¼ã‚ºã®è¨­å®šãªã©ã‚’é©å®œå®Ÿæ–½ã—ã¾ã™ã€‚

``id_ecdsa_sk.pub``ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«åã§å…¬é–‹éµãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã®ã§ã€é€šå¸¸SSHéµã‚’ç™»éŒ²ã™ã‚‹ã®ã¨åŒæ§˜ã«GitHubã«ç™»éŒ²ã—ã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/e7qs8x50hq89fhnm061xlk8qkhok)
ã“ã‚Œã§GitHubæ“ä½œã‚’å®Ÿæ–½ã™ã‚‹éš›ã«ä»¥ä¸‹ã®é€šã‚ŠSecurity KeyãŒè¦æ±‚ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
**å¤±æ•—æ™‚**
```
$ git clone git@github.com:github/secure_headers.git
Cloning into 'secure_headers'...
Confirm user presence for key ECDSA-SK SHA256:<finger print>
sign_and_send_pubkey: signing failed for ECDSA-SK "/path/.ssh/id_ecdsa_sk": invalid format
git@github.com: Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
```
**æˆåŠŸæ™‚**
```
$ git clone git@github.com:github/secure_headers.git
Cloning into 'secure_headers'...
Confirm user presence for key ECDSA-SK SHA256:<finger print>
User presence confirmed
remote: Enumerating objects: 6687, done.
remote: Counting objects: 100% (335/335), done.
remote: Compressing objects: 100% (216/216), done.
remote: Total 6687 (delta 196), reused 227 (delta 118), pack-reused 6352
Receiving objects: 100% (6687/6687), 1.54 MiB | 2.85 MiB/s, done.
Resolving deltas: 100% (3671/3671), done.
```