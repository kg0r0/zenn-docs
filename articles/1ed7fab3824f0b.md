---
title: ""
emoji: "ğŸ˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["oauth", "ssh"]
published: false
---
# ã¯ã˜ã‚ã«
ãƒ‡ãƒã‚¤ã‚¹ãƒ•ãƒ­ãƒ¼è‡ªä½“ã¯æ¯”è¼ƒçš„æ–°ã—ã„ä»•æ§˜ã§ã™ãŒã€Oktaä»¥å¤–ã«ã‚‚å®Ÿè£…ã—ã¦ã„ã‚‹èªå¯ã‚µãƒ¼ãƒãƒ¼ã¯è¤‡æ•°å­˜åœ¨ã—ã€éå»ã®ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãªã©ã§ã‚‚ç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

# Configure Device Authorization Grant Flow

## Before you begin

![](/images/1ed7fab3824f0b/settings-features.png)

## Configure an application to use the Device Authorization Grant 

![](/images/1ed7fab3824f0b/applications.png)

![](/images/1ed7fab3824f0b/app-integration.png)

![](/images/1ed7fab3824f0b/grant-type.png)

## Configure the Authorization Server policy rule for Device Authorization 

![](/images/1ed7fab3824f0b/authz-server.png)

![](/images/1ed7fab3824f0b/policy.png)

## Configure the smart device 

```bash
curl --request POST \
  --url https://${yourOktaDomain}/oauth2/default/v1/device/authorize \
  --header 'Accept: application/json' \
  --header 'Content-Type: application/x-www-form-urlencoded' \
  --data-urlencode 'client_id=${clientId}' \
  --data-urlencode 'scope=openid profile offline_access' | jq
{
    "device_code": "4ebdb4de-1f8b-4497-be01-ddfaf83c4e9c",
    "user_code": "MHXTFRPK",
    "verification_uri": "https://${yourOktaDomain}/activate",
    "verification_uri_complete": "https://${yourOktaDomain}/activate?user_code=MHXTFRPK",
    "expires_in": 600,
    "interval": 5
}
```
(â€»ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯[Request the device verification code](https://developer.okta.com/docs/guides/device-authorization-grant/main/#request-the-device-verification-code)ã‹ã‚‰å¼•ç”¨)

![](/images/1ed7fab3824f0b/device-activate.png)

```bash
curl --request POST \
  --url https://${yourOktaDomain}/oauth2/default/v1/token \
  --header 'Accept: application/json' \
  --header 'Content-Type: application/x-www-form-urlencoded' \
  --data-urlencode 'client_id=${clientId}' \
  --data-urlencode 'grant_type=urn:ietf:params:oauth:grant-type:device_code' \
  --data-urlencode 'device_code=${deviceCode}' | jq
{
  "token_type": "Bearer",
  "expires_in": 3600,
  "access_token": "eyJ ... ",
  "scope": "offline_access openid profile",
  "id_token": "eyJ ... "
}
```



# å‚è€ƒ
- https://developer.okta.com/docs/guides/device-authorization-grant/main/
- https://github.com/oktadev/okta-ssh-oauth-example